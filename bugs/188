{"status": "resolved", "priority": "bug", "title": "Move profile import code to Twisted: Bitbucket", "milestone": "0.10.12", "superceder": "", "nosylist": ["jesstess, paulproteus"], "assigned": "", "waitingon": "", "keywords": [], "id": "188", "files": [], "history": [{"message": "I've pushed the Twisted-based profile import code to Gitorious, and deployed it.\n\nThe old code had tests for the 404 scenario from Bitbucket. I would like the new\ncode to test that! But at least we handle it now, which is good enough.\n   \n", "author": "paulproteus"}, {"message": "See my comment.\n\nIs it worth it to switch to Trial for running our tests? Would that work\nstraightforwardly with the Django test suite? Yargle.\n\nNow I'm probably rambling off-topic.\n   \n", "author": "paulproteus"}, {"message": "I have this on origin (Gitorious) as origin/bitbucket_twist\n\nI don't want to ship it until we test the error cases that we used to test for.\nIn particular, we don't test what we do in case of the remote HTTP servers\ngiving us various error codes.\n\nI guess the thing to do is have a different fakeGetPage that sends a Twisted\nHTTP error down the errback chain.\n   \n", "author": "paulproteus"}, {"message": "This is mostly done in a local branch. I'm running the test suite to make sure\nthere are no regressions, and will then push.\n\nNote: We still need to test for the error conditions that the previous code used\nto handle. You can see these tests in mysite.customs.tests.OnlineBitbucket\n   \n", "author": "paulproteus"}, {"message": "Oh, the Twisted migration. Not quite done yet, but Bitbucket really should be easy.\n\nLet's tackle this specific one next, in 0.10.12.\n   \n", "author": "paulproteus"}, {"message": "The goal should be to ditch customs/bitbucket.py I think and move any remaining\nfunctionality into customs/profile_importers.py\n   \n", "author": "paulproteus"}]}