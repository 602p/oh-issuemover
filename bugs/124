{"status": "resolved", "priority": "feature", "title": "\"Creating tarballs\" mission needs a way to reset its state", "milestone": "0.11.01", "superceder": "", "nosylist": ["aldeka, ktarnowski, palhmbs, paulproteus, stump"], "assigned": "ktarnowski", "waitingon": "", "keywords": ["usability"], "id": "124", "files": [{"url": "http://openhatch.org/bugs/file136/0001-Added-JavaScript-logic-behind-mission-reset.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file128/0001-Added-reset-link-to-the-Creating-tarball-mission-ste.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file127/0001-Implemented-simple-mechanism-for-reseting-mission-as.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file129/0001-Implemented-simple-mechanism-for-reseting-mission-as.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file87/0001-Missions-Fix-for-tar-diff-patch.patch", "author": "palhmbs"}, {"url": "http://openhatch.org/bugs/file137/0002-Implemented-back-end-logic-for-mission-reset-feature.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file130/0003-Added-JS-module-to-be-used-on-mission-pages-for-rese.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file138/0003-Updated-templates-to-use-mission-reset-functionality.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file139/0004-Added-unit-tests-for-mission-reset-feature.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file131/0004-Adjusted-styles-so-file-upload-error-message-on-miss.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file140/0005-Fixed-a-typo-in-the-tests.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file132/0005-Implemented-logic-behind-mission-state-reset.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file133/0006-Added-reset-functionality-to-Tar-mission-templates.patch", "author": "ktarnowski"}, {"url": "http://openhatch.org/bugs/file90/upload-button.png", "author": "aldeka"}], "history": [{"message": "Sorry this dragged on!\n\nFeedback on patch 1: Looks great -- thanks for moving jQuery out to the HEAD; it\nmakes sense in the HEAD. I'm glad you use the new .live() functionality.\n\nOn patch 2: Some of your lines end in the \" \" (space) character. It's tidier for\nmerges if you don't do that. Also, it would be better if the test for the \"def\nreset()\" function came in the same commit.\n\nThe rest look good. If I were you, I would have squashed #5 into #4 so the\nhistory doesn't show the tests failing.\n\nAll in all, the patch set looks good! I'm deploying it now...\n\n(It also hints at future work in which we repeat ourselves less with regard to\nMissionStep names. And maybe other missions could use this JSification too. And\nthis functionality ought to work if you don't have JS.)\n\nI just tried it, and as the \"You have partially completed this mission\" faded\nout, I said, \"Wow! This is fun.\"\n\n(-:\n   \n", "author": "paulproteus"}, {"message": "With 0005-Fixed-a-typo-in-the-tests.patch applied after the four listed just\nearlier, I believe this satisfies everything paulproteus mentioned.\n   \n", "author": "pythonian4000"}, {"message": "This patch fixed a typo in tests -_-.\n   \n", "author": "ktarnowski"}, {"message": "Patches should be applied in the following order:\n#. 0001-Added-JavaScript-logic-behind-mission-reset.patch\n#. 0002-Implemented-back-end-logic-for-mission-reset-feature.patch\n#. 0003-Updated-templates-to-use-mission-reset-functionality.patch\n#. 0004-Added-unit-tests-for-mission-reset-feature.patch\n   \n", "author": "ktarnowski"}, {"message": "Fourth patch to apply.\n   \n", "author": "ktarnowski"}, {"message": "Third patch to apply.\n   \n", "author": "ktarnowski"}, {"message": "Second patch to apply.\n   \n", "author": "ktarnowski"}, {"message": "First patch to apply.\n   \n", "author": "ktarnowski"}, {"message": "I think I will go to sleep and review this on Tue, Feb 1; which means it will\nmiss the milestone. Sorry!\n\nAlso, ktarnowski, I am having trouble identifying which patch files you want me\nto apply+review.\n   \n", "author": "paulproteus"}, {"message": "Modified Tar mission templates to use the new reset functionality.\n   \n", "author": "ktarnowski"}, {"message": "Logic behind mission state reset.\n   \n", "author": "ktarnowski"}, {"message": "Adjusted styles for error messages displayed for File upload form.\n   \n", "author": "ktarnowski"}, {"message": "JavaScript module for resetting mission state using ajax request.\n   \n", "author": "ktarnowski"}, {"message": "New batch of patch files makes previous one's obsolete.\n\nApplication logic behind mission reset.\n   \n", "author": "ktarnowski"}, {"message": "Some thoughts:\n\n* When I click on \"reset\" and it takes me to\n<a href=\"http://127.0.0.1:8000/missions/tar/reset\">http://127.0.0.1:8000/missions/tar/reset</a> , I get a TypeError. You should write a\ntest for the reset functionality.\n\n* The reset should require a POST. It modifies the state of the database, so\nit's unsafe to do it with a GET. For a fun read, see\n<a href=\"http://bitworking.org/news/I_m_sorry__I_can_t_kiss_it_and_make_it_better_\">http://bitworking.org/news/I_m_sorry__I_can_t_kiss_it_and_make_it_better_</a>\n\n* I only get the \"reset\" link at the end of the mission. I think that each step,\nif it is already completed, should offer a \"reset\" button/link (or, alternately,\nthe \"Reset\" functionality should be moved to the start of the mission, so that\neach mission step's page can link to the reset discussion at the start of the\nmission, where people can decide to erase their state if they want).\n\nAs it stands, this is a huge improvement already. I'd push the current version\nif you write a test (and it passes) (and you change it to POST).\n   \n", "author": "paulproteus"}, {"message": "Rearranged \"success box\" for the sake of consistency.\n\nAdded reset link to the \"Create tarball\" page. Feedback required re. positioning of \nthe link (bottom instead of the top of the page etc.)\n   \n", "author": "ktarnowski"}, {"message": "Implemented mechanism for resetting mission state (whole or only for chosen steps).\n   \n", "author": "ktarnowski"}, {"message": "We miiiiight get to this during the January release. If so, that'd be swell. If\nnot, that's life. (-:\n   \n", "author": "paulproteus"}, {"message": "Now that we have unified the state handling for the training missions, this\nshould be easy.\n\nThe \"Creating tarballs\" missions should have a button at the top that says,\n\"Reset the mission (so you can try it again)\", and when you click it, you can\ntry the mission again.\n   \n", "author": "paulproteus"}, {"message": "The real problem here is that the tar/diff mission doesn't have the ability to\nreset the mission.\n\nAfter we do the cleanup in <a href=\"issue179\">issue179</a> we should be able to easily modify it to\nhave that. Then we can simplify the UI a lot.\n\nSadly this will obviate paulhomebus's patches, but it's the way that makes the\nmost sense.\n\nSo, to work on this, help us tackle <a href=\"issue179\">issue179</a> first! (Or wait for it.)\n   \n", "author": "paulproteus"}, {"message": "[17:23:57] &lt;paulproteus&gt; So (a) I think that the style breakage is new in the patch\n[17:24:15] &lt;paulproteus&gt; (b) the svn mission is clear, in that you can't re-do\nones you've already done, but you can reset the whole mission to undone state.\n[17:24:35] &lt;pythonian4000&gt; Is that the behaviour that the others should have?\n[17:24:51] &lt;skyfaller&gt; has anyone see palhbs recently?\n[17:24:53] &lt;paulproteus&gt; The svn mission is unique in that there is a strict\nlinearity and a great degree of state on our server.\n[17:24:58] &lt;paulproteus&gt; skyfaller: I'm afraid not\n[17:25:07] &lt;skyfaller&gt; erm, palhmbs, but yeah\n[17:25:08] &lt;pythonian4000&gt; Neither\n[17:25:10] &lt;paulproteus&gt; I probably scared him off by not reviewing his patch in\na timely fashion. Typical.\n[17:25:16] &lt;skyfaller&gt; hahaha, awww\n[17:25:37] &lt;pythonian4000&gt; What, scaring people off or not reviewing patches? ;P\n[17:25:41] &lt;Zathras&gt; paulproteus, well I did :P\n[17:26:01] &lt;paulproteus&gt; pythonian4000: So I think this mission should have a\nbig green \"success\" box, and a button to say, \"Want to try again? Reset this\nmission to not-yet-done state\"\n[17:26:08] &lt;paulproteus&gt; Except with maybe some more nice-sounding text.\n[17:26:24] &lt;paulproteus&gt; So much for it being \"bitesize\".\n[17:27:03] &lt;pythonian4000&gt; Yup, and in the case of a linear mission like svn or\ngit or maybe IRC, require the steps to be in sequence and have a reset on the\nmain page?\n[17:27:17] &lt;paulproteus&gt; Yeah, and preferably the top of the linear missions\nshould somehow indicate the linearity.\n[17:27:22] &lt;paulproteus&gt; Or somewhere on them.\n[17:28:11] &lt;paulproteus&gt; Maybe when it says, \"You've done this\" it can say, \"To\nreset this mission, go back to the start of it and click reset\"\n[17:28:28] &lt;paulproteus&gt; Like, in the same place as the reset button for\nnon-linear ones.\n[17:29:14] &lt;pythonian4000&gt; Yup.\n   \n", "author": "paulproteus"}, {"message": "The patch gets rid of the upload button (good), but the placement of the upload\nbutton (prior to success) is funky--see screenshot. Was it like this before? On\nthe unpacking tarball half of this mission the upload button appears normally....\n   \n", "author": "aldeka"}, {"message": "I am confident I have this right now! - please review!\n   \n", "author": "palhmbs"}, {"message": "I swapped some code round to get it to display right. \nI think I may have broken a div though on one of the .html's.\n\nHere is my very first patch!\n   \n", "author": "palhmbs"}, {"message": "On here:\n\n<a href=\"http://openhatch.org/missions/tar/upload#create-form\">http://openhatch.org/missions/tar/upload#create-form</a>\n\nIf you did it successfully, you still see the upload button. Totally lame.\n\nCredit to lfaraone for being aweso.me.\n   \n", "author": "paulproteus"}]}