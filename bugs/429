{"status": "resolved", "priority": "critical", "title": "SVN Mission - Diff Step doesn't work with a valid svn diff", "milestone": "0.12.02", "superceder": "", "nosylist": ["2mas, grantbow, palhmbs, paulproteus, trebon"], "assigned": "paulproteus", "waitingon": "", "keywords": [], "id": "429", "files": [{"url": "http://openhatch.org/bugs/file509/diff_mission_fail.patch", "author": "slandden"}], "history": [{"message": "With Shawn's ACK while sprinting remotely, I've fixed this issue. Thanks all for \nthe testing, and sorry it managed to stay broken. ):\n   \n", "author": "paulproteus"}, {"message": "Pull request here: <a href=\"https://github.com/openhatch/oh-mainline/pull/30\">https://github.com/openhatch/oh-mainline/pull/30</a>\n\nThis fixes the underlying subtle issue about our manage.py being dumb. As a side \nnote, if we never tried to support Heroku, we wouldn't have gotten into this \nmess.\n   \n", "author": "paulproteus"}, {"message": "seems like there are the diff mission in general needs some work\n\ngenerated with diff -u diffsingle.txt diffsingle-modified.txt &gt;\ndiff_mission_fail.patch\n\nand my diffsingle-modified.txt and the git diffsingle_result.txt have the same hash.\n   \n", "author": "slandden"}, {"message": "Good news! I can reproduce the problem on a local instance of the site. Working \non identifying the cause now.\n   \n", "author": "paulproteus"}, {"message": "I heard this might have something to do with initializing the svn repos that get\nchecked out for new users. I have no visibility to test or work on the server\naspect but I can help test the end user side of things.\n   \n", "author": "grantbow"}, {"message": "I have used a lot of bug systems but I find no sure clues to make sure I append a \ncomment and not change existing bug elements.\n\nI just tried but after trying many different permutations of white space and content I \nwas unable to gef my svn diff output accepted as input to the we  page.\n\nCan the error messages be made more helpful? The two different ones I got were \ncryptic.\n   \n", "author": "grantbow"}, {"message": "So... this works for me. I wonder what is going on with trebon's and grantbow's \nsystems.\n   \n", "author": "paulproteus"}, {"message": "I got an email from Grant Bow suggesting the problem remains... I'll see if I can \nreproduce it.\n   \n", "author": "paulproteus"}, {"message": "Using Win7 and Notepad++, the form returns \"The patch affects the wrong file.\"\nafter submitting a diff affecting only README. The output can be found\nhere:<a href=\"http://pastebin.com/FPnUnmWY\">http://pastebin.com/FPnUnmWY</a>\n   \n", "author": "trebon"}, {"message": "I just wrote a test for this, and code to ace the test:\n\n<a href=\"http://gitorious.org/openhatch/oh-\">http://gitorious.org/openhatch/oh-</a>\nmainline/commit/19fca5fca871aa6711c249ab5fb12a92190cdc1a\n\nWill deploy once Hudson likes it. Marking as resolved!\n   \n", "author": "paulproteus"}, {"message": "I keep having trouble writing a test case for this, for some reason, so I can\nnever quite figure out exactly how to fix it. People run it into this issue\nfairly frequently, I fear, so I'm glad there's a bug about it.\n\n2mas, can I interest you in trying to write an automated test for it? Then we\ncan nip it in the bud: the test will fail; we'll fix the subversion mission; the\ntest will pass; we'll deploy.\n   \n", "author": "paulproteus"}, {"message": "1. svn diff &gt;foo\n2. then open file file foo with Notepad++(or other edit \ntools)\n3. Ctrl+A of what you select and paste in the textarea\nso it can work\n\nNote:\nI see the blank line at the end,I think it must be \nincluded or the error will occur\n   \n", "author": "cmaj135"}, {"message": "Ok, the person who had problems with this mission step (t_p on IRC),\nfigured it out.\nIt was the age old bug of not having the return at the end of the diff.\n\nMaybe we should make that bit clearer!?\n   \n", "author": "palhmbs"}, {"message": "The SVN mission doesn't seem to be accepting a valid svn diff.\n\neg:\n$ svn diff\nIndex: README\n===================================================================\n--- README      (revision 3)\n+++ README      (working copy)\n@@ -1,5 +1,5 @@\n The secret word needed to infiltrate the compound is in word.txt. You\n-also will need to be wearing a red hat.  Good luck on your mision!\n+also will need to be wearing a red hat.  Good luck on your mission!\n\n   -- Mr. Bad\n\nShould be valid, but something broke, so its not.\n   \n", "author": "palhmbs"}]}