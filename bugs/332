{"status": "resolved", "priority": "critical", "title": "Add monitoring of the weekly project emails to /+meta/", "milestone": "0.11.03", "superceder": "", "nosylist": ["jesstess, nacarino, paulproteus"], "assigned": "nacarino", "waitingon": "", "keywords": [], "id": "332", "files": [{"url": "http://openhatch.org/bugs/file162/0002-I-ve-added-the-management-command-w-to-check-for-the.patch", "author": "nacarino"}, {"url": "http://openhatch.org/bugs/file160/id_rsa.pub", "author": "nacarino"}], "history": [{"message": "Hey all,\n\njesstess: thanks for the suggested change in process. I like the changes. I\nupdated <a href=\"https://openhatch.org/wiki/Monitoring#Making_changes\">https://openhatch.org/wiki/Monitoring#Making_changes</a> to match.\n\nThe changes themselves look good, too. Merged into \"master\"; \"testing\" branch\ndeleted.\n\nResolved!\n   \n", "author": "paulproteus"}, {"message": "We weren't getting mail because contact_groups wasn't defined for the WeeklyEmailStatus or \nMetaPage services. There were uncommitted changes to the service definitions, which I committed \nin a testing branch, and I added another commit adding these contact_groups.\n\npaulproteus: please review the testing branch and merge to master if everything looks good.\n\nFor future Nagios config changes, I recommend that we develop on a branch and have the author \nset him/herself as the commit author. That'll make reviews and debugging easier.\n   \n", "author": "jesstess"}, {"message": "(Adding jesstess, and setting status to 'chatting' since the next step isn't\nquite clear.)\n   \n", "author": "paulproteus"}, {"message": "I gave you some feedback on IRC. I'll repeat here:\n\nIn the future, try to keep related commits together. So the whitespace fixes\nthat aren't related to this commit's topic should be a separate commit/patch file.\n\nI've pushed the patch. I still can't get Nagios to see the right things. But\nyour SSH key is there -- see <a href=\"https://openhatch.org/wiki/Monitoring\">https://openhatch.org/wiki/Monitoring</a> for more info.\n   \n", "author": "paulproteus"}, {"message": "New test cases as well as some trailing whitespace elimination for nagios -w\nmanagement command.\n\nHave fun!\n   \n", "author": "nacarino"}, {"message": "re: the patch:\n\nIt looks very, very good. I'm going to increase my nitpickiness level and ask \nthat you remove the \" \" character at the end of the \"return 0\" line. Do that, and \nresubmit, and I'll push it.\n\nBefore I deploy, I'll say: it would be nice if you also add an \"integration\" \ntest, with:\n\n* One test for the CRITICAL case: with a fresh database, you would get a CRITICAL \nreturn value. (This is because the Timestamp is set to 0 by default.)\n\n* One test for the OK case: if you call .handle() on the send_weekly_emails \nmanagement command, and *then* do the Nagios check, it should say things are OK. \n(This is because running the send_weekly_emails management command should add a \nTimestamp value that your nagios.py code picks up on.)\n\nre: SSH key:\n\nI'll deploy this to <a href=\"mailto:nagios@linode2\">nagios@linode2</a> as soon as the patch above lands.\n\nre: this bug:\n\nThere is a bug \"status\" called \"needs-review\". Mark the bug with that status to \nmake sure we see it. I'm also marking the bug as \"Assigned To\" you.\n\nre: all of this:\n\nThis is totally excellent work. I really hope you stay involved! We have weekly \nmeetings to plan the release process, and discuss how our contributions are \ngoing, and I hope you come to them.\n   \n", "author": "paulproteus"}, {"message": "Unit tests and functions for management nagios -w command\n   \n", "author": "nacarino"}, {"message": "SSH key for access\n   \n", "author": "nacarino"}, {"message": "It seems to me that a good way to do this is to:\n\n* Add an option to the \"nagios\" management command: -w\n\n* Make it CRITICAL if the Timestamp for the weekly project emails is older than\n1 week.\n   \n", "author": "paulproteus"}, {"message": "We should really add some monitoring hooks here so that we know if it breaks.\n   \n", "author": "paulproteus"}]}