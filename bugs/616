{"status": "resolved", "priority": "bug", "title": "Uploading tarball created on a mac does not allow for dot underscore files", "milestone": "0.11.12", "superceder": "", "nosylist": ["paulproteus, sicophrenic, viv"], "assigned": "paulproteus", "waitingon": "", "keywords": [], "id": "616", "files": [{"url": "http://openhatch.org/bugs/file439/unnamed", "author": "viv"}], "history": [{"message": "Yep - it does for me!\n   \n", "author": "sicophrenic"}, {"message": "sicophrenic, thanks for the feedback.\n\nI updated <a href=\"https://openhatch.org/wiki/Tar_hints_for_Mac_OS_X_users\">https://openhatch.org/wiki/Tar_hints_for_Mac_OS_X_users</a> -- does that\nhandle everything now?\n   \n", "author": "paulproteus"}, {"message": "A few things to note:\n\n1) the command to create the tarball with the --exclude option has a problem with it: the correct \ncommand should be:\ntar zcvf myproject-0.1.tar.gz --exclude='._*' myproject-0.1/\n(running the current command throws an error and doesn't actually create the tarball)\n\n2) simply using that command to exclude ._* files doesn't complete the job for me. the peculiar thing \nis when i use 'ls -a', none of the ._* files show up. only when i extract the contents of the tarball are \nthe ._* files created. with the environment variable COPYFILE_DIABLE=true, however, I am able to \nsuccessfully create a tarball without ._* files\n   \n", "author": "sicophrenic"}, {"message": "Testing out the fix now.\n   \n", "author": "sicophrenic"}, {"message": "I will able to check that tonight..\n\nOn Thu, Dec 22, 2011 at 12:37 PM, Asheesh Laroia &lt;<a href=\"mailto:bugs@openhatch.org\">bugs@openhatch.org</a>&gt; wrote:\n\n&gt;\n&gt; Asheesh Laroia &lt;<a href=\"mailto:asheesh@asheesh.org\">asheesh@asheesh.org</a>&gt; added the comment:\n&gt;\n&gt; I deployed a fix for this that points users to that wiki page. I tested\n&gt; that it\n&gt; when I create a tarball with ._ files in it, the special error message\n&gt; shows up.\n&gt;\n&gt; I don't actually have a Mac, so I'd appreciate confirmation from someone\n&gt; that\n&gt; this detection code is working propeerly. sicophrenic, can you (or someone\n&gt; else\n&gt; who sees this) test it also and report back? I'll mark as need-review\n&gt; until some\n&gt; non-me person can validate that it is fixed.\n&gt;\n&gt; ----------\n&gt; status: chatting -&gt; need-review\n&gt;\n&gt; __________________________________________\n&gt; Roundup issue tracker &lt;<a href=\"mailto:bugs@openhatch.org\">bugs@openhatch.org</a>&gt;\n&gt; &lt;<a href=\"https://openhatch.org/bugs/issue616\">https://openhatch.org/bugs/issue616</a>&gt;\n&gt; __________________________________________\n&gt; _______________________________________________\n&gt; Devel mailing list\n&gt; <a href=\"mailto:Devel@lists.openhatch.org\">Devel@lists.openhatch.org</a>\n&gt; <a href=\"http://lists.openhatch.org/mailman/listinfo/devel\">http://lists.openhatch.org/mailman/listinfo/devel</a>\n&gt;\n   \n", "author": "viv"}, {"message": "I deployed a fix for this that points users to that wiki page. I tested that it\nwhen I create a tarball with ._ files in it, the special error message shows up.\n\nI don't actually have a Mac, so I'd appreciate confirmation from someone that\nthis detection code is working propeerly. sicophrenic, can you (or someone else\nwho sees this) test it also and report back? I'll mark as need-review until some\nnon-me person can validate that it is fixed.\n   \n", "author": "paulproteus"}, {"message": "I wrote up a wiki page for this:\n<a href=\"https://openhatch.org/wiki/Tar_hints_for_Mac_OS_X_users\">https://openhatch.org/wiki/Tar_hints_for_Mac_OS_X_users</a>\n\nNext I will modify the validation so that it points people at that link.\n   \n", "author": "paulproteus"}, {"message": "Thanks for testing this out!\n\nGiven the choices, which are:\n\n* Accept tar files that have this dot junk in them\n* Ask users to set an environment variable\n* Ask users to pass arguments to tar\n\nI prefer the final one. So Bill, I think what I will do is see if I can \ncook up arguments to \"tar\" that make it exclude these files, and then in \ntar file validation, if your tar file has the special dot stuff, we'll \npresent a Mac-specific message saying what options to pass to \"tar\".\n\nBill, can you submit the tar files you generated onto this bug so I can \ntest with them?\n\nIn the next day I'll push a fix that does the above stuff, and Bill maybe \nyou can confirm/deny that the instructions are reasonable?\n   \n", "author": "paulproteus"}, {"message": "I've found a way to disable ._ files being included in tar from this blog: \n<a href=\"http://norman.walsh.name/2008/02/22/tar\">http://norman.walsh.name/2008/02/22/tar</a>\n\nOS 10.4 and after: export COPYFILE_DISABLE=true;\nOS 10.3 and before: export COPY_EXTENDED_ATTRIBUTES_DISABLE=true;\n\nWe could instruct users to add this to their .bashrc.\n   \n", "author": "billputer"}, {"message": "It looks like the ._ file are created when a file is saved by a Mac OS X application. They don't appear \nwhen I save a file with vim, but when I save a file with TextMate, the ._ file appears.\n   \n", "author": "billputer"}, {"message": "I managed to accidentally delete the following message from sicophrenic. Whoops! \n<a href=\"https://openhatch.org/bugs/msg2717\">https://openhatch.org/bugs/msg2717</a>\n\"Inherently Mac OS X adds ._ files to a tar using the regular command tar zcvf as hinted for the final \nstep of the Tar Mission. The check on the uploaded tarball does not account for: myproject-\n0.1/._hello.c or myproject-0.1/._Makefile\"\n   \n", "author": "billputer"}, {"message": "I'm able to reproduce this. The tar command is including ._ files on OS X 10.6.8 (Intel). These are \nknown as \"resource forks\". There's more info here: <a href=\"http://support.apple.com/kb/TA20578\">http://support.apple.com/kb/TA20578</a>\n\nI've attempted to use dot_clean to remove the resource forks, unfortunately, it doesn't seem to \nremove the files, even when I use the \"-m Always delete dot underbar files.\" argument.\n   \n", "author": "billputer"}, {"message": "As an update: I just tried to reproduce the problem on a PPC mac by using \"curl\"\nto do the downloading. When I tar up the resulting directory, I get no ._ files.\n\nMaybe the ._ files are only made when one uses a web browser to download the files?\n\nI have seen this problem, so I am sure it is real; it will be helpful to get a\nclear way to reproduce it so we can be sure it is fixed when we think it is.\n   \n", "author": "paulproteus"}, {"message": "It looks like one easy fix is as follows:\n\n* Retain the current validation code\n* If we detect ._ files, then ask the user to please run dot_clean\n\nInfo on dot_clean:\n<a href=\"http://lifehacker.com/377011/delete-mac-system-files-with-dotclean\">http://lifehacker.com/377011/delete-mac-system-files-with-dotclean</a>\n\nIt's only available on Mac OS 10.5 or later, but I think that's okay.\n\nThen we can keep the high standard of correctness while still being helpful.\n   \n", "author": "paulproteus"}, {"message": "So I'm not quite sure what we should do in this situation.\n\nWe could tell you how to pass arguments to \"tar\" that make sure these \nfiles don't show up. But that seems a bit complex for this stage of \nlearning.\n\nWe could accept them, but then we'd be teaching people that it is okay to \ndistribute tarballs with this stuff in it, which isn't quite the right \nthing to teach people, either.\n\nWondering what others think,\n\n-- Asheesh.\n   \n", "author": "paulproteus"}]}