{"status": "resolved", "priority": "bug", "title": "Git Training Missions: Create A Patch will not accept an answer", "milestone": "0.11.11", "superceder": "", "nosylist": ["aviendhaSL, jesstess, paulproteus, viv"], "assigned": "jesstess", "waitingon": "", "keywords": [], "id": "596", "files": [{"url": "http://openhatch.org/bugs/file427/0001-Issue596.patch", "author": "viv"}, {"url": "http://openhatch.org/bugs/file412/0001-made-the-git-patching-mission-more-forgiving-with-it.patch", "author": "aviendhasl"}, {"url": "http://openhatch.org/bugs/file418/0002-Issue596.patch", "author": "viv"}, {"url": "http://openhatch.org/bugs/file424/0003-Issue596-Modified-diff-patch-submission-to-use-case-.patch", "author": "viv"}, {"url": "http://openhatch.org/bugs/file425/0004-Issue596-Modified-diff-patch-submission-to-use-case-.patch", "author": "viv"}, {"url": "http://openhatch.org/bugs/file419/unnamed", "author": "viv"}, {"url": "http://openhatch.org/bugs/file422/unnamed", "author": "viv"}], "history": [{"message": "I've deployed these changes. Thanks for sticking with this, viv!\n   \n", "author": "jesstess"}, {"message": "Hi viv,\n\nThis patch passes my review!\n\nI added a change on top and pushed to origin/master.\n\njesstess, would you be willing to push this (as part of reviewing <a href=\"issue445\">issue445</a> ) ?\nI'm assigning to you for now; de-assign if not.\n   \n", "author": "paulproteus"}, {"message": "Please find the latest patch.\n   \n", "author": "viv"}, {"message": "Please review both the patch <a href=\"file0004\">file 0004</a> and 0003.\n   \n", "author": "viv"}, {"message": "HI Jessica,\n\nI think I am good.. will come to IRC if face any problem.\n\nThanks,\n\nVivek\n\nOn Fri, Nov 18, 2011 at 7:07 PM, jesstess &lt;<a href=\"mailto:bugs@openhatch.org\">bugs@openhatch.org</a>&gt; wrote:\n\n&gt;\n&gt; jesstess &lt;<a href=\"mailto:jessica.mckellar@gmail.com\">jessica.mckellar@gmail.com</a>&gt; added the comment:\n&gt;\n&gt; Hi Vivek! I wanted to check in and see how this ticket was going. If you\n&gt; need any help with it, don't\n&gt; hesitate to get in touch on #openhatch, or feel free to reach out to me\n&gt; specifically\n&gt; (<a href=\"https://openhatch.org/people/jesstess/\">https://openhatch.org/people/jesstess/</a> lists a couple of ways).\n&gt;\n&gt; ----------\n&gt; nosy: +jesstess\n&gt;\n&gt; __________________________________________\n&gt; Roundup issue tracker &lt;<a href=\"mailto:bugs@openhatch.org\">bugs@openhatch.org</a>&gt;\n&gt; &lt;<a href=\"https://openhatch.org/bugs/issue596\">https://openhatch.org/bugs/issue596</a>&gt;\n&gt; __________________________________________\n&gt;\n   \n", "author": "viv"}, {"message": "Hi Vivek! I wanted to check in and see how this ticket was going. If you need any help with it, don't \nhesitate to get in touch on #openhatch, or feel free to reach out to me specifically \n(<a href=\"https://openhatch.org/people/jesstess/\">https://openhatch.org/people/jesstess/</a> lists a couple of ways).\n   \n", "author": "jesstess"}, {"message": "Yup.. I will fix it by next weekend..\n\nThanks,\n\nVivek\n\nOn Wed, Nov 9, 2011 at 3:43 PM, Asheesh Laroia &lt;<a href=\"mailto:bugs@openhatch.org\">bugs@openhatch.org</a>&gt; wrote:\n\n&gt;\n&gt; Asheesh Laroia &lt;<a href=\"mailto:asheesh@asheesh.org\">asheesh@asheesh.org</a>&gt; added the comment:\n&gt;\n&gt; This didn't quite make it in time for 0.11.10, but hopefully it will make\n&gt; it\n&gt; into a later release!\n&gt;\n&gt; ----------\n&gt; milestone: 0.11.10 -&gt; later\n&gt;\n&gt; __________________________________________\n&gt; Roundup issue tracker &lt;<a href=\"mailto:bugs@openhatch.org\">bugs@openhatch.org</a>&gt;\n&gt; &lt;<a href=\"https://openhatch.org/bugs/issue596\">https://openhatch.org/bugs/issue596</a>&gt;\n&gt; __________________________________________\n&gt;\n   \n", "author": "viv"}, {"message": "This didn't quite make it in time for 0.11.10, but hopefully it will make it\ninto a later release!\n   \n", "author": "paulproteus"}, {"message": "Hey Vivek,\n\nI just applied your patch locally to my copy of the code, and it seems that my\nvalid patch that I submitted to\n<a href=\"http://127.0.0.1:8000/missions/git/diff/submit#gitdiff-form\">http://127.0.0.1:8000/missions/git/diff/submit#gitdiff-form</a> doesn't validate.\n\nRunning this command:\n\n./bin/sqlite_mysite test missions.GitViewTests\n\nindicates that the test suite can reproduce the failure. I can't push this until\nthe tests pass.\n\nAlso, some general style feedback:\n\nFirst, good job renaming the GitRepository.validate_diff_and_commit_if_ok method\nso that it does not say that it does the validation anymore.\n\nIn missions/git/forms.py you raise a ValidationError, which is excellent, but\nthen you also try to set data['git_diff_error_message']. That line will never be\nexecuted because function execution stops at a raise command. You should delete it.\n\nIn general, the point of the switch to Django form validation is that we don't\nhave to pass special-purpose error messages down into the template; instead, the\nform object will keep the information inside it, and so the logic in the\ntemplate that checks the form object for errors will print the errors itself.\n\nSimilarly, in mysite/missions/git/views.py you do not need the \"else\" line. Try\nwithout it, and see if it works.\n \nThe only other quibble I have is that in missions/git/forms.py the line  after\nthe data['git_diff_error_message'] operation is a line that ends in some\nwhitespace. Remove the space characters (e.g. \" \") from the end of the line.\n\nSorry that it took me a day to get to reviewing this. Make sure you run the test\nsuite before submitting; if you have a patch that doesn't pass the tests, but\nyou're not sure why, do feel free to submit it in the broken state, but let us\nknow that you need help with it.\n   \n", "author": "paulproteus"}, {"message": "Ready for review....\n   \n", "author": "viv"}, {"message": "Okay, cool!\n   \n", "author": "paulproteus"}, {"message": "I took a look on this. I think I probably be able to finish by next week.. seems \nstraightforward.. but testing will take some time for me...Please reassign if \nsomeone wants to finish by 31st Oct...\n   \n", "author": "viv"}, {"message": "taking over..\n   \n", "author": "viv"}, {"message": "aviendha, we're aiming for having this in an October 31 release date. Do you\nthink you can addresses these issues by then?\n\nIf not, if someone else is willing to take your patch and adds some commits on\ntop to address the feedback listed here, is that okay?\n\nLet us know!\n   \n", "author": "paulproteus"}, {"message": "&lt;paulproteus&gt; Can I suggest you change the variable name from \"success_count\" to\n\"success\"?\n&lt;aviendhaSL&gt; definitely\n&lt;paulproteus&gt; I'm also a little weirded out by returning a string there, rather\nthan a boolean. I'll see what the other controllers there do; it seems like the\nnicest thing would be if this were a Django form validation error, and you\nraised an exception.\n&lt;paulproteus&gt; In general, mega thank you for this patch.\n&lt;paulproteus&gt; We don't seem to be using the Django forms library here at all, to\nmy disappointment.\n&lt;aviendhaSL&gt; Any suggestion on how to change that then? I was just trying to\nfigure out how to propagate a more useful error message up to return.\n&lt;paulproteus&gt; If you're willing to accept refactoring-level suggestions, I think\nthat validation and committing should be separate methods on that class. Perhaps\nGitDiffMission should just have the validate() part, and the commit() part\nshould move into the class GitRepository.\n--&gt; lotia (~<a href=\"mailto:lotia@l.monkey.org\">lotia@l.monkey.org</a>) has joined #openhatch\n&lt;paulproteus&gt; Ah hah.\n&lt;paulproteus&gt; mysite/missions/forms.py -- there is a DiffForm\n&lt;paulproteus&gt; The best thing to do is move the validation into DiffForm, in a\nnew method called clean_diff(), as per\n<a href=\"https://docs.djangoproject.com/en/1.2/ref/forms/validation/\">https://docs.djangoproject.com/en/1.2/ref/forms/validation/</a>\n&lt;paulproteus&gt; Then you can raise ValidationError() and that will show up like\nany other form validation error, in the web UI.\n&lt;paulproteus&gt; ConfigForm.clean_user_email() is a good example of this, in\nmysite/missions/git/forms.py\n&lt;paulproteus&gt; How does that sound?\n&lt;paulproteus&gt; I feel a bit bad that I'm asking you to clean up code problems in\nthe code that you're modifying, in ways that go beyond the original desired change.\n&lt;aviendhaSL&gt; sounds like a plan. It's fine.\n&lt;paulproteus&gt; I'll leave this conversation log on the bug so it's easy to find\nnext time.\n   \n", "author": "paulproteus"}, {"message": "Attached a patch that makes the submission tests for forgiving and gives a more\nuseful error message. I did not change the unit tests to check for the\nmore-forgiving-ness, but I did check it manually.\n   \n", "author": "aviendhasl"}, {"message": "well... yes. The comma also need to be gone. \"Hello world\" is the only\nacceptable string, and it must be exactly that.\n   \n", "author": "aviendhaSL"}, {"message": "nope. I just checked with the extra space deleted, and it still doesn't work.\n   \n", "author": "aviendhaSL"}, {"message": "Asheesh mentioned it might be due to the double space, but the error message still \nsucks\n   \n", "author": "paultag"}, {"message": "When I try to submit what I think is a perfectly good patch on the second task\nof the git training mission\n(<a href=\"http://openhatch.org/missions/git/diff/submit#gitdiff-form\">http://openhatch.org/missions/git/diff/submit#gitdiff-form</a>), the grader will\nnot accept my input. I get the very unuseful error message \"patch file is\nincorrect, try again\". Input is given below.\n\nFrom f3c4e46bcf63cbdf15ae45df0fde7a0b73081bb8 Mon Sep 17 00:00:00 2001\nFrom: Aviendha Lannister &lt;<a href=\"mailto:aviendha1591@BreathOfAir.local\">aviendha1591@BreathOfAir.local</a>&gt;\nDate: Tue, 20 Sep 2011 20:14:49 -0400\nSubject: [PATCH] Fixed hello world\n\n---\n hello.py |    2 +-\n 1 files changed, 1 insertions(+), 1 deletions(-)\n\ndiff --git a/hello.py b/hello.py\nindex 680b306..12942f8 100644\n--- a/hello.py\n+++ b/hello.py\n@@ -1,4 +1,4 @@\n #! /usr/bin/env python\n \n #Author: The Brain\n-print \"Goodbye world!\"\n+print \"Hello,  world!\"\n-- \n1.7.6.1\n   \n", "author": "aviendhaSL"}]}