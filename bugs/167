{"status": "resolved", "priority": "bug", "title": "snapshot importer crashes with integrity error", "milestone": "0.11.01", "superceder": "", "nosylist": ["paulproteus, zathras"], "assigned": "paulproteus", "waitingon": "", "keywords": [], "id": "167", "files": [], "history": [{"message": "I just tried it with a 2011-01-20 snapshot, did an import, then imported a\n2011-01-22 snapshot, and it worked fine.\n\nMarking as resolved.\n   \n", "author": "paulproteus"}, {"message": "I'm testing this right now. It might take a while, but I'm on it.\n   \n", "author": "paulproteus"}, {"message": "It would be good to check and resolve this by the end of 0.10.12.\n   \n", "author": "paulproteus"}, {"message": "This can be easily verified by anyone. Does not require dev skills. However I am\nnot prepared to do so as I do not want to potentially fubar my environment so I\ncannot develop and test code. Better to test on a fresh install\n\nIf it cannot be reproduced that way (fresh install, import data, wait a day or\nmore, do a new fresh import on top of current db) the bug is a one time hick up.\nOtherwise a serious bug\n\nnice issue for someone who wants to help out but is not really into the project\nor thinks (s)he has limited skills imho\n\nto sum up: Testplan:\n1. install openhatch\n2. test installation\n3. download snapshot\n4. import snapshot\n5. test\n6. wait 1 ormore days\n7. download new(er) snapshot\n8. import snapshot\nif no errors occur like reported previously : bug was an one off hick up: bug\ncan be closed\nif error(s) occur : bug is genuine and requires attention by a developer\n   \n", "author": "zathras"}, {"message": "Since we can't reproduce it, the next step is to try to do an import of a\nsnapshot on top of your local database.\n\nMaybe that can reproduce it?\n\nOtherwise I think we should close it unless we figure out how to reproduce the\nexception.\n   \n", "author": "paulproteus"}, {"message": "Thanks for writing this bug up. You helpfully made it clear which snapshot you\nwere loading.\n\nCan you try with a fresh database, and the most recent snapshot? I can't\nreproduce the issue, and I did just try.\n   \n", "author": "paulproteus"}, {"message": "Yikes! Will look at this!\n   \n", "author": "paulproteus"}, {"message": "./bin/mysite loaddata ../snapshots/2010-11-12.json \n/home/system/www2/openhatch.org/oh-mainline/eggs/windmill-1.4-py2.6.egg/windmill/browser/__init__.py:20:\nUserWarning: Module tracext was already imported from None, but\n/usr/lib/pymodules/python2.6 is being added to sys.path\n  from pkg_resources import resource_string\nInstalling json fixture '../snapshots/2010-11-12' from absolute path.\nProblem installing fixture '../snapshots/2010-11-12.json': Traceback (most\nrecent call last):\n  File\n\"/home/system/www2/openhatch.org/oh-mainline/parts/mysite/django/core/management/commands/loaddata.py\",\nline 163, in handle\n    obj.save()\n  File\n\"/home/system/www2/openhatch.org/oh-mainline/parts/mysite/django/core/serializers/base.py\",\nline 163, in save\n    models.Model.save_base(self.object, raw=True)\n  File\n\"/home/system/www2/openhatch.org/oh-mainline/parts/mysite/django/db/models/base.py\",\nline 495, in save_base\n    rows = manager.filter(pk=pk_val)._update(values)\n  File\n\"/home/system/www2/openhatch.org/oh-mainline/parts/mysite/django/db/models/query.py\",\nline 448, in _update\n    return query.execute_sql(None)\n  File\n\"/home/system/www2/openhatch.org/oh-mainline/parts/mysite/django/db/models/sql/subqueries.py\",\nline 124, in execute_sql\n    cursor = super(UpdateQuery, self).execute_sql(result_type)\n  File\n\"/home/system/www2/openhatch.org/oh-mainline/parts/mysite/django/db/models/sql/query.py\",\nline 2347, in execute_sql\n    cursor.execute(sql, params)\n  File\n\"/home/system/www2/openhatch.org/oh-mainline/parts/mysite/django/db/backends/util.py\",\nline 19, in execute\n    return self.cursor.execute(sql, params)\n  File\n\"/home/system/www2/openhatch.org/oh-mainline/parts/mysite/django/db/backends/mysql/base.py\",\nline 84, in execute\n    return self.cursor.execute(query, args)\n  File \"/usr/lib/pymodules/python2.6/MySQLdb/cursors.py\", line 166, in execute\n    self.errorhandler(self, exc, value)\n  File \"/usr/lib/pymodules/python2.6/MySQLdb/connections.py\", line 35, in\ndefaulterrorhandler\n    raise errorclass, errorvalue\nIntegrityError: (1062, \"Duplicate entry 'GNOME-Do' for key 'name'\")\n   \n", "author": "zathras"}]}